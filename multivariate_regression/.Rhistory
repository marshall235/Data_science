rowdiff<-(post-pre)# Finding the differnce of the rows between the two data
rowmean<-((post+pre)/2)# summing up the values on each row of the two data, and dividing by 2 to find their mean value.
par(mfrow=c(1,4))
plot(pre,post,main = "FREDRICK OTIENO MALOWA 18/03992",xlab = "Premenstrual intake",ylab = "Postmenstrual intake")# The fucntion plots Post data against Pre data
abline(a=0,b=1,lwd=3,col="blue")# the funtion, adds a straight line from the origin, and the line has a slope of 1,; width of 3, and it is colored blue
plot(rowmean,rowdiff,ylim = range(rowdiff,0))
hist(rowdiff,main = "Histogram of the Row Difference Between Post and Pre Data")
qqnorm(rowdiff)
qqline(rowdiff)
### t.test conducts statistical tests for data that follows a normal distirbution
# the two functions qqnorm(),and qqline () helps us to determine if the data follows a normal distribution
# From the results, most of the points are approximately lying on the qqline; thus we can judge that the data follows a normal distribution
# Therefore, we can conclude that a t.test is suitable for this data.
##### The difficulty that may arise
#### This problem can be overcome through;
## Renaming the colunm name of the variable using the following commands
#names()<-c("","","")# we put the data set in the first brackets, and the new column names in the second bracket separated with commas
# we can also use colnames("dataset")<-c("new column names",..)# This is similar to to the names()<-c()command
# Another way to overcome this problem is to assign a new name to that variable when analyzing it
library(ISwR)
data(tlc)
attach(tlc)
summary(lm(log(tlc) ~ ., data=tlc))
plot(lm(log(tlc) ~ ., data=tlc))
drop1(lm(log(tlc) ~ ., data=tlc))
drop1(lm(log(tlc) ~ . - age, data=tlc))
plot(log(tlc) ~ height,data=tlc)
plot(lm(tlc ~ .,data=tlc))
#### QUESTION 2
library(smss)
data("crime2005")
attach(crime2005)
plot(PO,MU)
fit_MU_PO<-lm(MU~PO)
fit_MU_PO
newdata<-data.frame(PO=seq(5.2,18.5,.1))
newdata
predict1<-predict(fit_MU_PO,interval = "pred",newdata = newdata)
predict1
conf1<-predict(fit_MU_PO,interval = "conf",newdata = newdata)
conf1
resid(fit_MU_PO)
MU1<-MU[-51]
MU1
PO1<-PO[-51]
PO1
fit_MU_PO1<-lm(MU1~PO1)
plot(PO1,MU1)
###### analyisis of variance (ANOVA)
#### the data that will be used isred.cells.folate
library(ISwR)
library(knitr) # knitr is for creating nice reports
red_cell<-red.cell.folate
head(red_cell)
kable(head(red_cell))
attach(red_cell)
summary(red_cell)
structure(ventilation)
str(ventilation)
anova(lm(folate~ventilation))
#### example 2 : use juul data
data(juul)
attach(juul)
kable(juul[40:46,])
str(tanner)
####
anova(lm(igf1~tanner)) #### WRONG
#### DEFINE TANNER AS A FACTOR
juul$tanner<-factor(juul$tanner,labels = c("I","II","III","IV","V "))
detach(juul)
attach(juul)
str(juul$tanner)
anova(lm(igf1~tanner))
#### relaxing assumption of equal variances
oneway.test(folate~ventilation)
#### Bartletts Test: determines whether to use oneway.text, or anova
bartlett.test(folate~ventilation)
kruskal.test(folate~ventilation) ### non parametric test
##### The difficulty that may arise
#### This problem can be overcome through;
## Renaming the colunm name of the variable using the following commands
#names()<-c("","","")# we put the data set in the first brackets, and the new column names in the second bracket separated with commas
# we can also use colnames("dataset")<-c("new column names",..)# This is similar to to the names()<-c()command
# Another way to overcome this problem is to assign a new name to that variable when analyzing it
library(ISwR)
data(tlc)
attach(tlc)
pairs(tlc)
summary(lm(log(tlc) ~ ., data=tlc))
plot(lm(log(tlc) ~ ., data=tlc))
drop1(lm(log(tlc) ~ ., data=tlc))
drop1(lm(log(tlc) ~ . - age, data=tlc))
plot(log(tlc) ~ height,data=tlc)
plot(lm(tlc ~ .,data=tlc))
#### QUESTION 2
library(smss)
data("crime2005")
attach(crime2005)
plot(PO,MU)
fit_MU_PO<-lm(MU~PO)
fit_MU_PO
set.seed(5234)
newdata<-data.frame(PO=seq(5.2,18.5,.1))
newdata
predict1<-predict(fit_MU_PO,interval = "pred",newdata = newdata)
predict1
conf1<-predict(fit_MU_PO,interval = "conf",newdata = newdata)
conf1
resid(fit_MU_PO)
MU1<-MU[-51]
MU1
PO1<-PO[-51]
PO1
fit_MU_PO1<-lm(MU1~PO1)
plot(PO1,MU1)
setwd("~/Downloads")
read.csv("/home/fredy/Downloads/Age-standardized suicide rates (1).csv")
kenya<-read.csv("/home/fredy/Downloads/Age-standardized suicide rates (1).csv")
View(kenya)
attach(kenya)
kenya=lm(X2016,X2015,X2010,X2000)
kenya=lm(country~X2016,X2015,X2010,X2000)
kenya=lm(Country~X2016,X2015,X2010,X2000)
hist(kenya)
hist(X2016)
y<-((kenya$X2016,kenya$X2015,kenya$X2010,kenya$X2000)
y<-(kenya$X2016,kenya$X2015,kenya$X2010,kenya$X2000)
y<-[kenya$X2016,kenya$X2015,kenya$X2010,kenya$X2000]
qqnorm(X2016)
qqline(X2015)
library(ISwR)
mydata5=cystfibr
tail(mydata5)
plot(mydata5)
pairs(mydata5,gap = 0,cex.labels =.9 ) # pairs/plot plots pairwise scatter plots
# gap-reduces the gap between the scatterplots
#cex.labels reduces the sizes of the labels.
par(mex=.5) # the function adjusts margins
attach(mydata5)
#model specification and Output
# this is done by setting up a model formula with + between the explanatory variables
myfit5=lm(pemax~age+sex+height+weight+bmp+fev1+rv+frc)
summary(myfit5)
# from the summary there is no significant t-valu but the F, value is significant
(r_adjust=1-25.47^2/var(pemax))
anova(myfit5)
(new_ss= 955.4+155+632.3+2862.2+1549.1+561.9+194.6+92.4)
(new_mss=new_ss/8)
(new_F_stat=new_mss/648.7)
#new_p value
1-pf(new_F_stat,8,15)
myfit5=lm(pemax~age+sex+height+weight+bmp+fev1+rv+frc+tlc)
myfit6=lm(pemax~age)
anova(myfit6,myfit5)
## nested-means that one model is a subst of the other
summary(lm(pemax~age+sex+height+weight+bmp+fev1+rv+frc+tlc))
lm(formula = pemax~age+sex+height+weight+bmp+fev1+rv+frc+tlc)
summary(lm(pemax~age+sex+height+weight+bmp+fev1+rv+frc))
summary(lm(pemax~age+sex+height+weight+bmp+fev1+rv))
summary(lm(pemax~age+sex+height+weight+bmp+fev1))
summary(lm(pemax~age+sex+height+weight+bmp))
summary(lm(pemax~age+height+weight+bmp))
summary(lm(pemax~height+weight+bmp))
summary(lm(pemax~weight+bmp))
summary(lm(pemax~weight))
summary(lm(pemax~age+weight+height))
summary(lm(pemax~age+weight))
summary(lm(pemax~age))
summary(pemax~height)
summary(lm(pemax~weight))
View(mydata5)
kenya<-read.csv("/home/fredy/Downloads/Age-standardized suicide rates (1).csv")
View(kenya)
attach(kenya)
kenya=lm(Country~X2016,X2015,X2010,X2000)
hist(kenya)
hist(X2016)
y<-[kenya$X2016,kenya$X2015,kenya$X2010,kenya$X2000]
qqnorm(X2016)
qqline(X2015)
read.csv("/home/fredy/Downloads/who_suicide_statistics.csv")
LAND<-read.csv("/home/fredy/Downloads/who_suicide_statistics.csv")
View(LAND)
attach(LAND)
plot(suicides_no)
qqnorm(suicides_no)
qqline(suicides_no)
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<--0.25*Z_stock+sqrt(1--0.25^2*rnorm(11000,0.05,0.2))
Z_bond
# Affter simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<--0.25*Z_stock+sqrt(1--0.25^2*rnorm(11000,0.05,0.2))
Z_bond
# After simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<--0.25*Z_stock+sqrt(1--0.25^2*rnorm(11000,0.05,0.2))
Z_bond
# After simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<--0.25*Z_stock+sqrt(1--0.25^2*rnorm(11000,0.05,0.2))
Z_bond
# Affter simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
Z_bondl
Z_bondl
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_bondl*sqrt(dt))
return(expo)
}
Fvdt1<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_bondl*sqrt(dt))
return(expo)
}
Future_value_stock<-starting_value*Fvdt1(0.08,0.3,seq(to=35,from=1,1))
Future_value_bond
Future_value_stock
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<--0.25*Z_stock+sqrt(1--0.25^2*rnorm(11000,0.05,0.2))
Z_bondl
# Affter simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Fvdt1<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_bondl*sqrt(dt))
return(expo)
}
Future_value_stock<-starting_value*Fvdt1(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<-0.25*Z_stock+sqrt(1-0.25*rnorm(11000,0.05,0.2))
Z_bond
# Affter simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
# FREDRICK OTIENO MALOWA
# 18/03992
#KCA UNIVERSITY
#BSC ACTUARIAL SCINCE
# FINANCIAL DERIVATIVES ASSIGNMENT
#simulating using a correlation of -0.25
# the stock index and and bond index follow the standard normal logdiffusion process
Z_stock<-rnorm(11000,0.08,0.3) #
Z_bondl<-0.25*Z_stock+sqrt(1-0.25*rnorm(11000,0.05,0.2))
Z_bond
# Affter simulating the values of the bonds and stock,we shall compute future values of investment savings
#FVdtsock=value at the start*e(u-1/2q^2)dt+q*_zstocksqrt(dt)
Accum_annuity=80000*30# Accumulated amount of annity
Accum_annuity
starting_value= Accum_annuity/35 # determining the starting value of investement.
starting_value
Fvdt<-function(u,q,dt){
expo<-exp((u-q^2)*dt+q*Z_stock*sqrt(dt))
return(expo)
} # creating a fucntion to compute the amounts for each of the years starting from 0 to 35
Future_value_stock<-starting_value*Fvdt(0.08,0.3,seq(to=35,from=1,1))
Future_value_stock
Future_value_bond<-starting_value*Fvdt(0.05,0.3,seq(to=35,from=1,1))# after creating the function, we plug in the values
Future_value_bond
let_qs<-seq(to=1,from=0.01,0.01)# assigning the values of q
let_qs
qb<-1-let_qs# the values of qb
qb
Future_bond_and_stock<-let_qs*Future_value_stock+qb*Future_value_bond# finding the future bond of stock
Future_bond_and_stock
present_value_annuity_factor<-(1-1.04^-30)/0.04# this is the present value annuity factor
present_value_annuity_factor
Annuity_fvp<-Future_bond_and_stock/present_value_annuity_factor
Annuity_fvp
Annuity_var<-quantile(Annuity_fvp,0.1)# computed VaR
Annuity_var
average_annuity<-mean(Annuity_fvp)
average_annuity
Savings_given_the_target<-48000/average_annuity# Savings amount given the taget
Savings_given_the_target
target_var<-quantile(Annuity_fvp,0.9)# Target VaR
target_var
Savings_given_the_target_computed_var<-target_var/Annuity_var
Savings_given_the_target
